---
title: AnatomÃ­a de un Loop
---

import { Callout } from 'nextra/components'
import RalphAccessGate from '../../components/RalphAccessGate'

# LecciÃ³n 3.3: AnatomÃ­a de un Loop

<RalphAccessGate>

## Los 4 Archivos Clave

Todo sistema Ralph necesita exactamente 4 archivos:

```
mi-proyecto/
â”œâ”€â”€ loop.sh          # El script que reinicia Claude
â”œâ”€â”€ PROMPT_build.md  # Las instrucciones para Claude
â”œâ”€â”€ PLAN.md          # La lista de tareas
â””â”€â”€ PROGRESS.md      # Los aprendizajes acumulados
```

Veamos cada uno en detalle.

---

## 1. loop.sh - El Orquestador

Este script es el corazÃ³n del sistema. Su trabajo es simple: **reiniciar Claude indefinidamente**.

```bash
#!/bin/bash

# loop.sh - El orquestador de Ralph

while true; do
    echo "ğŸ”„ Iniciando nueva iteraciÃ³n de Ralph..."
    echo "â° $(date)"
    echo "---"

    # Ejecutar Claude Code con el prompt
    claude -p "$(cat PROMPT_build.md)"

    # PequeÃ±a pausa entre iteraciones
    echo ""
    echo "âœ… IteraciÃ³n completada. Reiniciando en 5 segundos..."
    sleep 5
done
```

### CaracterÃ­sticas importantes:

- **Loop infinito** - ContinÃºa hasta que lo detengas (Ctrl+C)
- **Timestamp** - Registra cuÃ¡ndo empezÃ³ cada iteraciÃ³n
- **Pausa** - Da tiempo a revisar antes del siguiente ciclo

---

## 2. PROMPT_build.md - Las Instrucciones

Este archivo contiene TODO lo que Claude necesita saber. Se lee **al inicio de cada iteraciÃ³n**, asÃ­ que siempre tiene contexto fresco.

```markdown
# PROMPT_build.md

## Tu Rol
Eres un desarrollador senior trabajando en [nombre del proyecto].

## El Proyecto
[DescripciÃ³n breve del proyecto]

## Instrucciones CRÃTICAS
1. Lee PLAN.md para ver las tareas pendientes
2. Ejecuta UNA tarea a la vez
3. Marca la tarea como completada cuando termines
4. Actualiza PROGRESS.md con aprendizajes
5. Si encuentras un bloqueador, documÃ©ntalo y pasa a otra tarea

## Stack TÃ©cnico
- Lenguaje: [X]
- Framework: [Y]
- Base de datos: [Z]

## Convenciones
- [Lista de convenciones de cÃ³digo]
- [Patrones a seguir]
- [Cosas a evitar]

## Archivos Clave
- `/src/` - CÃ³digo fuente
- `/tests/` - Tests
- `/docs/` - DocumentaciÃ³n

## Ahora
1. Lee PLAN.md
2. Elige la primera tarea pendiente
3. EjecÃºtala completamente
4. Actualiza los archivos de estado
```

<Callout type="warning">
  Este archivo es tu **contrato** con Claude. Cuanto mÃ¡s especÃ­fico seas, mejores resultados.
</Callout>

---

## 3. PLAN.md - La Lista de Tareas

El archivo que Claude lee y modifica para saber quÃ© hacer.

```markdown
# PLAN.md - Tareas del Proyecto

## âœ… Completadas
- [x] Configurar proyecto base
- [x] Crear estructura de carpetas
- [x] Instalar dependencias

## ğŸ”„ En Progreso
- [ ] Implementar autenticaciÃ³n de usuarios

## ğŸ“‹ Pendientes
- [ ] Crear endpoint de login
- [ ] Crear endpoint de registro
- [ ] Implementar JWT tokens
- [ ] Crear middleware de auth
- [ ] Escribir tests de autenticaciÃ³n

## ğŸš« Bloqueados
(ninguno actualmente)

## ğŸ“ Notas
- Usar bcrypt para passwords
- JWT expira en 24h
```

### Reglas del PLAN.md:

1. **Tareas atÃ³micas** - Cada tarea debe ser completable en una iteraciÃ³n
2. **Orden lÃ³gico** - Las dependencias van primero
3. **Checkboxes** - Usa `[x]` y `[ ]` para marcar estado
4. **SecciÃ³n de bloqueados** - Para tareas que no se pueden hacer aÃºn

---

## 4. PROGRESS.md - La Memoria Persistente

AquÃ­ Claude guarda lo que aprende. Es crucial para no repetir errores.

```markdown
# PROGRESS.md - Aprendizajes del Proyecto

## Decisiones de Arquitectura
- Usamos PostgreSQL en vez de MongoDB por las relaciones
- JWT en lugar de sesiones por escalabilidad

## Bugs Encontrados y Solucionados
- El puerto 3000 estaba ocupado -> cambiado a 3001
- Error de CORS -> aÃ±adido middleware especÃ­fico

## Convenciones Establecidas
- Nombres de archivos en kebab-case
- Funciones en camelCase
- Tipos/Interfaces en PascalCase

## Dependencias Instaladas
- express: servidor web
- jsonwebtoken: manejo de JWT
- bcrypt: hash de passwords

## Notas para Futuras Iteraciones
- Recordar ejecutar tests antes de marcar como completado
- El usuario admin tiene ID=1, no borrarlo en tests
```

### Por quÃ© es importante:

- **Evita repetir errores** - Si Claude documentÃ³ un bug, no lo repetirÃ¡
- **Mantiene consistencia** - Las convenciones se preservan
- **Acelera iteraciones** - No pierde tiempo redescubriendo cosas

---

## El Flujo Completo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  loop.sh ejecuta â”€â”€â–¶ Claude inicia con PROMPT_build.md     â”‚
â”‚                              â”‚                              â”‚
â”‚                              â–¼                              â”‚
â”‚                    Lee PLAN.md para tareas                  â”‚
â”‚                              â”‚                              â”‚
â”‚                              â–¼                              â”‚
â”‚                   Lee PROGRESS.md para contexto             â”‚
â”‚                              â”‚                              â”‚
â”‚                              â–¼                              â”‚
â”‚                    Ejecuta UNA tarea                        â”‚
â”‚                              â”‚                              â”‚
â”‚                              â–¼                              â”‚
â”‚            Actualiza PLAN.md (marca completada)             â”‚
â”‚                              â”‚                              â”‚
â”‚                              â–¼                              â”‚
â”‚         Actualiza PROGRESS.md (si aprendiÃ³ algo)           â”‚
â”‚                              â”‚                              â”‚
â”‚                              â–¼                              â”‚
â”‚                    Termina la sesiÃ³n                        â”‚
â”‚                              â”‚                              â”‚
â”‚                              â–¼                              â”‚
â”‚               loop.sh reinicia â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                                                   â”‚         â”‚
â”‚                          â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

<div className="mt-8 text-center">
  <a href="/ralph/fase-specs" className="inline-block px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition">
    Siguiente: Fase 1 - Specs â†’
  </a>
</div>

</RalphAccessGate>

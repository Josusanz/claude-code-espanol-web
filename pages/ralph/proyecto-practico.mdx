---
title: Proyecto PrÃ¡ctico
---

import { Callout } from 'nextra/components'
import RalphAccessGate from '../../components/RalphAccessGate'

# LecciÃ³n 3.7: Proyecto PrÃ¡ctico

<RalphAccessGate>

## Construye una App Completa con Ralph

Es hora de poner todo en prÃ¡ctica. Vamos a construir una **API de gestiÃ³n de notas** desde cero usando Ralph Loop.

---

## El Proyecto: Notes API

Una API REST completa con:
- CRUD de notas
- AutenticaciÃ³n JWT
- CategorÃ­as/etiquetas
- BÃºsqueda de texto
- Tests automatizados

**Tiempo estimado:** 2-4 horas de Ralph (sin supervisiÃ³n continua)

---

## Paso 1: Crear los Archivos Base

### PROMPT_build.md

```markdown
# PROMPT_build.md - Notes API

## Resumen del Proyecto
API REST para gestiÃ³n de notas personales con autenticaciÃ³n,
categorÃ­as y bÃºsqueda. Stack moderno con TypeScript y SQLite.

## Tu Rol
Eres un desarrollador senior construyendo esta API. Sigues
buenas prÃ¡cticas, escribes tests, y documentas decisiones.

## Stack TÃ©cnico
- Runtime: Node.js 20
- Lenguaje: TypeScript 5
- Framework: Express.js 4
- ORM: Prisma
- Base de datos: SQLite (desarrollo)
- Testing: Vitest
- AutenticaciÃ³n: JWT (jsonwebtoken)
- ValidaciÃ³n: Zod

## Estructura del Proyecto
```
notes-api/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts              # Entry point
â”‚   â”œâ”€â”€ app.ts                # Express app config
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ auth.ts           # Rutas de auth
â”‚   â”‚   â””â”€â”€ notes.ts          # Rutas de notas
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”œâ”€â”€ authController.ts
â”‚   â”‚   â””â”€â”€ notesController.ts
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ auth.ts           # JWT verification
â”‚   â”‚   â””â”€â”€ errorHandler.ts
â”‚   â”œâ”€â”€ schemas/              # Zod schemas
â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â””â”€â”€ notes.ts
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ jwt.ts
â”‚       â””â”€â”€ password.ts
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ auth.test.ts
â”‚   â””â”€â”€ notes.test.ts
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ vitest.config.ts
```

## Convenciones de CÃ³digo
1. Async/await siempre (nunca callbacks)
2. Errores con try/catch y middleware centralizado
3. ValidaciÃ³n de input en cada endpoint con Zod
4. Respuestas: { success: boolean, data?: any, error?: string }
5. CÃ³digos HTTP correctos (200, 201, 400, 401, 404, 500)

## Modelos de Datos

### User
- id: Int (auto)
- email: String (unique)
- password: String (hashed)
- createdAt: DateTime

### Note
- id: Int (auto)
- title: String (max 200)
- content: String
- category: String (opcional)
- userId: Int (FK)
- createdAt: DateTime
- updatedAt: DateTime

## Endpoints Requeridos

### Auth
- POST /auth/register - Crear cuenta
- POST /auth/login - Obtener token

### Notes (protegidos)
- GET /notes - Listar notas del usuario
- GET /notes/:id - Obtener nota especÃ­fica
- POST /notes - Crear nota
- PUT /notes/:id - Actualizar nota
- DELETE /notes/:id - Eliminar nota
- GET /notes/search?q=texto - Buscar en tÃ­tulo/contenido

## Reglas CRÃTICAS
- â›” NUNCA guardar passwords en texto plano
- â›” NO crear endpoints sin validaciÃ³n
- â›” NO modificar datos de otros usuarios
- âœ… Verificar ownership antes de CRUD
- âœ… Ejecutar tests despuÃ©s de cada feature
- âœ… Documentar decisiones en PROGRESS.md

## Flujo de Trabajo
1. Lee PLAN.md - encuentra la primera tarea pendiente
2. Lee PROGRESS.md - obtÃ©n contexto previo
3. Implementa la tarea completamente
4. Ejecuta tests relacionados
5. Si pasan: marca [x] en PLAN.md
6. Si fallan: arregla y documenta en PROGRESS.md
7. Termina la sesiÃ³n
```

### PLAN.md

```markdown
# PLAN.md - Notes API

## ðŸ“Š Estado
- Inicio: [fecha actual]
- Progreso: 0%

## âœ… Completadas
(ninguna aÃºn)

## ðŸ”„ En Progreso
(ninguna)

## ðŸ“‹ Pendientes

### Fase 1: Setup del Proyecto
- [ ] Crear package.json con dependencias
- [ ] Configurar TypeScript (tsconfig.json)
- [ ] Configurar Vitest
- [ ] Crear estructura de carpetas

### Fase 2: Base de Datos
- [ ] Configurar Prisma
- [ ] Crear modelo User en schema.prisma
- [ ] Crear modelo Note en schema.prisma
- [ ] Generar cliente Prisma y migraciÃ³n

### Fase 3: AutenticaciÃ³n
- [ ] Crear utils/password.ts (hash, verify)
- [ ] Crear utils/jwt.ts (sign, verify)
- [ ] Crear schemas/auth.ts (validaciÃ³n Zod)
- [ ] Crear authController (register, login)
- [ ] Crear routes/auth.ts
- [ ] Crear middleware/auth.ts (protecciÃ³n)
- [ ] Test: registro de usuario
- [ ] Test: login y token vÃ¡lido

### Fase 4: CRUD de Notas
- [ ] Crear schemas/notes.ts (validaciÃ³n)
- [ ] Crear notesController (create)
- [ ] Crear notesController (list)
- [ ] Crear notesController (getById)
- [ ] Crear notesController (update)
- [ ] Crear notesController (delete)
- [ ] Crear routes/notes.ts
- [ ] Test: crear nota
- [ ] Test: listar notas
- [ ] Test: editar nota
- [ ] Test: eliminar nota
- [ ] Test: no acceder a notas de otros

### Fase 5: BÃºsqueda
- [ ] AÃ±adir endpoint GET /notes/search
- [ ] Implementar bÃºsqueda en tÃ­tulo y contenido
- [ ] Test: bÃºsqueda funciona correctamente

### Fase 6: FinalizaciÃ³n
- [ ] Middleware de manejo de errores
- [ ] Revisar todos los tests pasan
- [ ] Crear app.ts con configuraciÃ³n Express
- [ ] Crear index.ts (entry point)
- [ ] Documentar endpoints en README.md

## ðŸš« Bloqueados
(ninguno)

## ðŸ“ Notas
- JWT secret: usar variable de entorno
- Password: bcrypt con 10 rounds
```

### PROGRESS.md

```markdown
# PROGRESS.md - Notes API

## Decisiones de Arquitectura
(se llenarÃ¡n durante el desarrollo)

## Bugs y Soluciones
(se llenarÃ¡n durante el desarrollo)

## Dependencias Instaladas
(se llenarÃ¡n durante el desarrollo)

## Notas para Futuras Iteraciones
- Verificar que tests pasen antes de continuar
- Documentar cualquier cambio de enfoque
```

### loop.sh

Usa el script de la lecciÃ³n anterior.

---

## Paso 2: Lanzar Ralph

```bash
# Crear directorio del proyecto
mkdir notes-api
cd notes-api

# Crear los archivos (copia el contenido de arriba)
# PROMPT_build.md
# PLAN.md
# PROGRESS.md
# loop.sh

# Dar permisos
chmod +x loop.sh

# Â¡Lanzar!
./loop.sh
```

---

## Paso 3: Monitorear

En otra terminal:

```bash
# Ver progreso
watch -n 30 "cat PLAN.md | grep -E '\[.\]'"

# Ver cambios recientes
watch -n 60 "ls -lt src/ 2>/dev/null | head -10"

# Ver log
tail -f ralph_log_*.txt
```

---

## Paso 4: Puntos de VerificaciÃ³n

<Callout type="info">
  Verifica estos hitos durante la ejecuciÃ³n:
</Callout>

| DespuÃ©s de... | Verificar |
|---------------|-----------|
| ~15 min | Setup completo, package.json existe |
| ~30 min | Prisma configurado, modelos creados |
| ~60 min | Auth funciona, tests de auth pasan |
| ~90 min | CRUD bÃ¡sico completo |
| ~120 min | BÃºsqueda funciona, tests pasan |
| ~150 min | Todo completado, README documentado |

---

## Paso 5: Resultado Esperado

Al terminar, deberÃ­as tener:

```bash
notes-api/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts              âœ…
â”‚   â”œâ”€â”€ app.ts                âœ…
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ auth.ts           âœ…
â”‚   â”‚   â””â”€â”€ notes.ts          âœ…
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”œâ”€â”€ authController.ts âœ…
â”‚   â”‚   â””â”€â”€ notesController.tsâœ…
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ auth.ts           âœ…
â”‚   â”‚   â””â”€â”€ errorHandler.ts   âœ…
â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â”œâ”€â”€ auth.ts           âœ…
â”‚   â”‚   â””â”€â”€ notes.ts          âœ…
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ jwt.ts            âœ…
â”‚       â””â”€â”€ password.ts       âœ…
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma         âœ…
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ auth.test.ts          âœ…
â”‚   â””â”€â”€ notes.test.ts         âœ…
â”œâ”€â”€ README.md                  âœ…
â”œâ”€â”€ package.json              âœ…
â””â”€â”€ tsconfig.json             âœ…
```

Y todos los tests pasando:

```bash
npm test
# âœ“ auth.test.ts (3 tests)
# âœ“ notes.test.ts (6 tests)
# All tests passed!
```

---

## Troubleshooting del Proyecto

<details className="my-4 p-4 bg-slate-100 dark:bg-gray-800/50 rounded-lg">
  <summary className="font-semibold cursor-pointer">Ralph se atora en setup</summary>
  <p className="mt-3 text-slate-600 dark:text-gray-400">
    Verifica que tienes Node.js 20+ instalado. Si el problema persiste, ejecuta manualmente
    `npm init -y` y reinicia Ralph.
  </p>
</details>

<details className="my-4 p-4 bg-slate-100 dark:bg-gray-800/50 rounded-lg">
  <summary className="font-semibold cursor-pointer">Tests fallan repetidamente</summary>
  <p className="mt-3 text-slate-600 dark:text-gray-400">
    AÃ±ade una nota en PROGRESS.md explicando el problema. Si persiste, detÃ©n Ralph,
    ejecuta los tests manualmente para diagnosticar, y ajusta las specs.
  </p>
</details>

<details className="my-4 p-4 bg-slate-100 dark:bg-gray-800/50 rounded-lg">
  <summary className="font-semibold cursor-pointer">Claude no marca tareas completadas</summary>
  <p className="mt-3 text-slate-600 dark:text-gray-400">
    Verifica que el formato en PLAN.md es exactamente `- [ ]` y `- [x]` (con espacios).
    AÃ±ade instrucciÃ³n explÃ­cita en PROMPT_build.md sobre el formato.
  </p>
</details>

</RalphAccessGate>
